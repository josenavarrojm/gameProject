// MqttClient.tsx
import { useState, useEffect } from 'react';
import mqtt, { MqttClient } from 'mqtt';


const datos = [{ 'id': 'ESP-01', 'temp': 34.0625, 'temp_alert': 3, 'state_posture': 1, 'acc_deg': 373 }, { 'id': 'ESP-01', 'temp': 34.0625, 'temp_alert': 3, 'state_posture': 1, 'acc_deg': 226 }, { 'id': 'ESP-01', 'temp': 34.0625, 'temp_alert': 3, 'state_posture': 1, 'acc_deg': 79 }, { 'id': 'ESP-01', 'temp': 34.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 34.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 34.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 15 }, { 'id': 'ESP-01', 'temp': 34.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 34.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 34.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 15 }, { 'id': 'ESP-01', 'temp': 34.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 15 }, { 'id': 'ESP-01', 'temp': 34.4375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 20 }, { 'id': 'ESP-01', 'temp': 34.4375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 34.4375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 34.4375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 18 }, { 'id': 'ESP-01', 'temp': 34.4375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 34.4375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 34.4375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 34.4375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 34.4375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 34.4375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 34.75, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 34.75, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 34.75, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 34.75, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 17 }, { 'id': 'ESP-01', 'temp': 34.75, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 34.75, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 34.75, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 34.75, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 34.75, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 34.75, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 34.9375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 34.9375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 34.9375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 34.9375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 17 }, { 'id': 'ESP-01', 'temp': 34.9375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 34.9375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 34.9375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 34.9375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 34.9375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 34.9375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 35.125, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 18 }, { 'id': 'ESP-01', 'temp': 35.125, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 35.125, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 35.125, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 17 }, { 'id': 'ESP-01', 'temp': 35.125, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 35.125, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 35.125, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 35.125, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 35.125, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 35.125, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 35.25, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 35.25, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 35.25, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 35.25, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 17 }, { 'id': 'ESP-01', 'temp': 35.25, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 35.25, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 35.25, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 35.25, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 35.25, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 13 }, { 'id': 'ESP-01', 'temp': 35.25, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 35.375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 35.375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 35.375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 35.375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 16 }, { 'id': 'ESP-01', 'temp': 35.375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 13 }, { 'id': 'ESP-01', 'temp': 35.375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 13 }, { 'id': 'ESP-01', 'temp': 35.375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 35.375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 13 }, { 'id': 'ESP-01', 'temp': 35.375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 13 }, { 'id': 'ESP-01', 'temp': 35.375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 13 }, { 'id': 'ESP-01', 'temp': 35.4375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 18 }, { 'id': 'ESP-01', 'temp': 35.4375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 18 }, { 'id': 'ESP-01', 'temp': 35.4375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 35.4375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 18 }, { 'id': 'ESP-01', 'temp': 35.4375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 15 }, { 'id': 'ESP-01', 'temp': 35.4375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 16 }, { 'id': 'ESP-01', 'temp': 35.4375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 17 }, { 'id': 'ESP-01', 'temp': 35.4375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 21 }, { 'id': 'ESP-01', 'temp': 35.4375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 28 }, { 'id': 'ESP-01', 'temp': 35.4375, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 34 }, { 'id': 'ESP-01', 'temp': 35.5, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 44 }, { 'id': 'ESP-01', 'temp': 35.5, 'temp_alert': 3, 'state_posture': 1, 'acc_deg': 46 }, { 'id': 'ESP-01', 'temp': 35.5, 'temp_alert': 3, 'state_posture': 1, 'acc_deg': 47 }, { 'id': 'ESP-01', 'temp': 35.5, 'temp_alert': 3, 'state_posture': 1, 'acc_deg': 45 }, { 'id': 'ESP-01', 'temp': 35.5, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 41 }, { 'id': 'ESP-01', 'temp': 35.5, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 41 }, { 'id': 'ESP-01', 'temp': 35.5, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 41 }, { 'id': 'ESP-01', 'temp': 35.5, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 41 }, { 'id': 'ESP-01', 'temp': 35.5, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 41 }, { 'id': 'ESP-01', 'temp': 35.5, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 41 }, { 'id': 'ESP-01', 'temp': 35.5625, 'temp_alert': 3, 'state_posture': 1, 'acc_deg': 48 }, { 'id': 'ESP-01', 'temp': 35.5625, 'temp_alert': 3, 'state_posture': 1, 'acc_deg': 49 }, { 'id': 'ESP-01', 'temp': 35.5625, 'temp_alert': 3, 'state_posture': 1, 'acc_deg': 51 }, { 'id': 'ESP-01', 'temp': 35.5625, 'temp_alert': 3, 'state_posture': 1, 'acc_deg': 49 }, { 'id': 'ESP-01', 'temp': 35.5625, 'temp_alert': 3, 'state_posture': 1, 'acc_deg': 45 }, { 'id': 'ESP-01', 'temp': 35.5625, 'temp_alert': 3, 'state_posture': 1, 'acc_deg': 45 }, { 'id': 'ESP-01', 'temp': 35.5625, 'temp_alert': 3, 'state_posture': 1, 'acc_deg': 46 }, { 'id': 'ESP-01', 'temp': 35.5625, 'temp_alert': 3, 'state_posture': 1, 'acc_deg': 46 }, { 'id': 'ESP-01', 'temp': 35.5625, 'temp_alert': 3, 'state_posture': 1, 'acc_deg': 47 }, { 'id': 'ESP-01', 'temp': 35.5625, 'temp_alert': 3, 'state_posture': 1, 'acc_deg': 46 }, { 'id': 'ESP-01', 'temp': 35.625, 'temp_alert': 3, 'state_posture': 1, 'acc_deg': 50 }, { 'id': 'ESP-01', 'temp': 35.625, 'temp_alert': 3, 'state_posture': 1, 'acc_deg': 46 }, { 'id': 'ESP-01', 'temp': 35.625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 38 }, { 'id': 'ESP-01', 'temp': 35.625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 26 }, { 'id': 'ESP-01', 'temp': 35.625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 17 }, { 'id': 'ESP-01', 'temp': 35.625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 35.625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 13 }, { 'id': 'ESP-01', 'temp': 35.625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 13 }, { 'id': 'ESP-01', 'temp': 35.625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 13 }, { 'id': 'ESP-01', 'temp': 35.625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 13 }, { 'id': 'ESP-01', 'temp': 35.6875, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 35.6875, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 35.6875, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 18 }, { 'id': 'ESP-01', 'temp': 35.6875, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 17 }, { 'id': 'ESP-01', 'temp': 35.6875, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 13 }, { 'id': 'ESP-01', 'temp': 35.6875, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 13 }, { 'id': 'ESP-01', 'temp': 35.6875, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 35.6875, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 35.6875, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 35.6875, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 35.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 35.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 35.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 35.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 17 }, { 'id': 'ESP-01', 'temp': 35.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 35.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 13 }, { 'id': 'ESP-01', 'temp': 35.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 13 }, { 'id': 'ESP-01', 'temp': 35.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 13 }, { 'id': 'ESP-01', 'temp': 35.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 13 }, { 'id': 'ESP-01', 'temp': 35.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 34.5, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 18 }, { 'id': 'ESP-01', 'temp': 34.5, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 34.5, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 34.5, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 16 }, { 'id': 'ESP-01', 'temp': 34.5, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 34.5, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 12 }, { 'id': 'ESP-01', 'temp': 34.5, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 12 }, { 'id': 'ESP-01', 'temp': 34.5, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 12 }, { 'id': 'ESP-01', 'temp': 34.5, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 13 }, { 'id': 'ESP-01', 'temp': 34.5, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 13 }, { 'id': 'ESP-01', 'temp': 34.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 18 }, { 'id': 'ESP-01', 'temp': 34.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 18 }, { 'id': 'ESP-01', 'temp': 34.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 18 }, { 'id': 'ESP-01', 'temp': 34.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 16 }, { 'id': 'ESP-01', 'temp': 34.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 13 }, { 'id': 'ESP-01', 'temp': 34.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 13 }, { 'id': 'ESP-01', 'temp': 34.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 13 }, { 'id': 'ESP-01', 'temp': 34.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 13 }, { 'id': 'ESP-01', 'temp': 34.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 13 }, { 'id': 'ESP-01', 'temp': 34.0625, 'temp_alert': 3, 'state_posture': 0, 'acc_deg': 13 }, { 'id': 'ESP-01', 'temp': 33.625, 'temp_alert': 2, 'state_posture': 0, 'acc_deg': 18 }, { 'id': 'ESP-01', 'temp': 33.625, 'temp_alert': 2, 'state_posture': 0, 'acc_deg': 18 }, { 'id': 'ESP-01', 'temp': 33.625, 'temp_alert': 2, 'state_posture': 0, 'acc_deg': 18 }, { 'id': 'ESP-01', 'temp': 33.625, 'temp_alert': 2, 'state_posture': 0, 'acc_deg': 17 }, { 'id': 'ESP-01', 'temp': 33.625, 'temp_alert': 2, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 33.625, 'temp_alert': 2, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 33.625, 'temp_alert': 2, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 33.625, 'temp_alert': 2, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 33.625, 'temp_alert': 2, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 33.625, 'temp_alert': 2, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 33.3125, 'temp_alert': 2, 'state_posture': 0, 'acc_deg': 20 }, { 'id': 'ESP-01', 'temp': 33.3125, 'temp_alert': 2, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 33.3125, 'temp_alert': 2, 'state_posture': 0, 'acc_deg': 19 }, { 'id': 'ESP-01', 'temp': 33.3125, 'temp_alert': 2, 'state_posture': 0, 'acc_deg': 17 }, { 'id': 'ESP-01', 'temp': 33.3125, 'temp_alert': 2, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 33.3125, 'temp_alert': 2, 'state_posture': 0, 'acc_deg': 15 }, { 'id': 'ESP-01', 'temp': 33.3125, 'temp_alert': 2, 'state_posture': 0, 'acc_deg': 15 }, { 'id': 'ESP-01', 'temp': 33.3125, 'temp_alert': 2, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 33.3125, 'temp_alert': 2, 'state_posture': 0, 'acc_deg': 14 }, { 'id': 'ESP-01', 'temp': 33.3125, 'temp_alert': 2, 'state_posture': 0, 'acc_deg': 13 }];




const MqttCliente = () => {
  const [isConnected, setIsConnected] = useState(false);
  const [message, setMessage] = useState('');
  const brokerUrl = 'ws://broker.emqx.io:8083/mqtt';
  const topic = 'mqttservices/test'
  const [indexer, setIndexer] = useState(0)
  console.log(indexer);


  const [client, setClient] = useState<MqttClient | null>(null);
  useEffect(() => {
    const mqttClient = mqtt.connect(brokerUrl);

    mqttClient.on('connect', () => {
      console.log('Connected to broker');
      setIsConnected(true);
      mqttClient.subscribe(topic, (err) => {
        if (err) console.error('Subscription error:', err);
      });
    });

    mqttClient.on('message', (receivedTopic, payload) => {
      if (receivedTopic === topic) {
        setMessage(payload.toString());
        console.log('Message received:', payload.toString());
      }
    });

    setClient(mqttClient);

    return () => {
      mqttClient.end();
    };
  }, [brokerUrl, topic]);

  const handleSendMessage = () => {
    if (client && isConnected) {
      setInterval(() => {
        setIndexer((prevIndex) => {
          // Calcula el nuevo índice
          const newIndex = prevIndex === 169 ? 0 : prevIndex + 1;

          // Imprime el valor actual de indexer antes de actualizarlo
          console.log(newIndex, datos[newIndex]);
          client.publish(topic, JSON.stringify(datos[newIndex]));
          console.log('Message sent: ', datos[newIndex]);

          // Retorna el nuevo valor de indexer para que se actualice
          return newIndex;
        });
      }, 2000);
    }
  };
  // const data = {
  //   'id': 'ESP-01',
  //   'temp': 33.3125,
  //   'temp_alert': 2,
  //   'state_posture': 0,
  //   'acc_deg': 13
  // }

  return (
    <div>
      <h2>MQTT Client</h2>
      <p>Status: {isConnected ? 'Connected' : 'Disconnected'}</p>
      <p>Last message: {message}</p>
      <button onClick={() => handleSendMessage()}>Send Message</button>
    </div>
  );
};

export default MqttCliente;
